<div class="container-fluid">
	<div class="row">
		<div class="box col-xs-10 col-xs-offset-1">
			<h1><%= @place.name %></h1>
			<i><%= @place.address %></i>
			<br><br>
			<p><%= @place.description %></p>
 			<% if @place.longitude.present? && @place.latitude.present? %>
 				<br>
				<div id="map" data-latitude="<%= @place.latitude %>" data-longitude="<%= @place.longitude %>"></div>
				<br>
			<% end %>
			<% if current_user == @place.user %>
				<div class="pull-right">
					<%= link_to "Edit", edit_place_path(@place), class: "btn btn-primary" %>
					<%= link_to "Delete", place_path(@place), method: :delete, data: {confirm: "Are you sure you want to delete this place?"}, class: "btn btn-primary" %>
				</div>
			<% end %>
		</div>
	</div>
	<div class="row">
		<div class="box col-xs-10 col-xs-offset-1">
			<!-- This button triggers the comment submission modal -->
			<button type="button" class="btn btn-primary add-comment-btn" data-toggle="modal" data-target="#myModal">Add Comment</button>
			<h2>Comments</h2>
			<% @place.comments.each do |comment| %>
				<blockquote>
					<% (1..comment.rating).each do %>
						<span class="glyphicon glyphicon-star"></span>
					<% end %> 
					- <%= comment.message -%>
					<small><%= comment.user.email %></small>
				</blockquote>
			<% end %>
		</div>
	</div>
</div>

<!-- Comment submission modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title" id="myModalLabel">Add Your Comment</h4>
			</div>
			<%= simple_form_for @comment, wrapper: :vertical_form, url: place_comments_path(@place) do |f| %>
				<div class="modal-body">
					<%= f.input :message %>
					<%= f.input :rating, collection: Comment::RATING_MAP, include_blank: false %>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
					<%= f.submit "Add Comment", class: "btn btn-primary" %>
				</div>
			<% end %>
		</div>
	</div>
</div>